{% extends base_layout %}

{% block header_title %}
    {% trans %}Trip{% endtrans %}
{% endblock %}

{% block content %}

	<div class="row">
		<div class="col-md-6"><!-- Google map -->
			<div id="panel" class="col-lg-12 input-group">
      			<input id="target" type="text" placeholder="Location" class="form-control">
      			<span class="input-group-addon"><span class="glyphicon glyphicon-search"></span></span>
    		</div>
    		<div id="map-canvas"></div>
		</div>
		
		<div class="col-md-6"><!-- Informations about selection -->
			<!-- Name of the place -->
			<h3>Busan</h3>
			
			<!-- Custom description -->
			<p>This city is so cool !</p>
			
			<hr />
			<h4>Jagalchi Market</h4>
			<!-- Custom description -->
			<p>The best fishmarket I've ever been to</p>
			<!-- Wikipedia description -->
			<p><img src="/img/wiki.png" alt="Wiki">
			<em><small>
			Jagalchi Fish Market is a fish market in the neighborhood of Nampo-dong in Jung-gu, and Chungmu-dong, Seo-gu, Busan, South Korea.[1] The market is located on the edge of Nampo Port, Busan. The name is said to have originated from jagal (gravel in Korean) because the market used to be surrounded by many gravels.[2] This is one of the ten landmarks of Busan, so many tourists visit there to shop.
			</small></em></p>
			
			<!-- Related pictures -->
			<div class="row">
				<div class="col-sm-6 col-md-3">
					<a href="#" class="thumbnail">
						<img src="/img/sample1.jpg" alt="Sample 1">
					</a>
				</div>
				<div class="col-sm-6 col-md-3">
					<a href="#" class="thumbnail">
						<img src="/img/sample2.jpg" alt="Sample 2">
					</a>
				</div>
				<div class="col-sm-6 col-md-3">
					<a href="#" class="thumbnail">
						<img src="/img/sample3.jpg" alt="Sample 3">
					</a>
				</div>
			</div>
		</div>
	</div>
    
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
    <script>
		function initialize() {
  			var map = new google.maps.Map(document.getElementById('map-canvas'), {
    			mapTypeId: google.maps.MapTypeId.ROADMAP,
    			zoom: 7
  			});
  			var defaultBounds = new google.maps.LatLngBounds(
      			new google.maps.LatLng(35.129554, 129.015642),
      			new google.maps.LatLng(35.209554, 129.105642));
  			map.fitBounds(defaultBounds);

  			var input = /** @type {HTMLInputElement} */(document.getElementById('target'));
  			console.log(input);
  			var searchBox = new google.maps.places.SearchBox(input);
  			var markers = [];

  			google.maps.event.addListener(searchBox, 'places_changed', function() {
    		var places = searchBox.getPlaces();

    		for (var i = 0, marker; marker = markers[i]; i++) {
      			marker.setMap(null);
    		}
    		
    		
    		markers = [];
    		var bounds = new google.maps.LatLngBounds();
    		for (var i = 0, place; place = places[i]; i++) {
      			var image = {
        			url: place.icon,
        			size: new google.maps.Size(71, 71),
        			origin: new google.maps.Point(0, 0),
        			anchor: new google.maps.Point(17, 34),
        			scaledSize: new google.maps.Size(25, 25)
      			};

      			var marker = new google.maps.Marker({
        			map: map,
        			icon: image,
        			title: place.name,
        			position: place.geometry.location
      			});
      			
      			var infowindow = new google.maps.InfoWindow({
      				content: "Button"
  				});
      			
      			google.maps.event.addListener(marker, 'click', function() {
    				infowindow.open(map,marker);
  				});

      			markers.push(marker);

      			bounds.extend(place.geometry.location);
    		}


		
			
    		map.fitBounds(bounds);
  		});

  		google.maps.event.addListener(map, 'bounds_changed', function() {
    		var bounds = map.getBounds();
    		searchBox.setBounds(bounds);
  		});
  		
	
	
		console.log("hallo");
    		// sample markers
    		var sample_markers = [[35.137879, 129.120598],
    								[35.156968, 129.181023],
    								[35.101089, 129.032537]];
    		for (var i = 0; i < 3; i++) {
    		
  			 	console.log(i);
  			 	var marker = new google.maps.Marker({
        			map: map,
        			icon: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
        			position: new google.maps.LatLng(sample_markers[i][0], sample_markers[i][1]),
      			});
      		}
	
	var clickMarker;

	function placeMarker(location) {
  		
    		clickMarker = new google.maps.Marker({
      			position: location,
      			info: new google.maps.InfoWindow({
      				content: "New Location <button class='button primary-btn'>Create</button>"
  				}),
      			
      			map: map
    		});
    		clickMarker.info.open(map, clickMarker);
  		
  		
	}
	google.maps.event.addListener(map, 'click', function(event) {
  		placeMarker(event.latLng);
	});
	}


	google.maps.event.addDomListener(window, 'load', initialize);
    </script>
    
{% endblock %}