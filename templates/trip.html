{% extends base_layout %}

{% block header_title %}
    {% trans %}Trip{% endtrans %}
{% endblock %}

{% block content %}

	<div class="row">
		<div class="col-md-6"><!-- Google map -->
			<div id="panel" class="col-lg-12 input-group">
      			<input id="target" type="text" placeholder="Location" class="form-control">
      			<span class="input-group-addon"><span class="glyphicon glyphicon-search"></span></span>
    		</div>
    		<div id="map-canvas"></div>
		</div>
		
		<div class="col-md-6"><!-- Informations about selection -->
			<!-- Name of the place -->
			<h3>Busan</h3>
			
			<!-- Custom description -->
			<p>This city is so cool !</p>
			
			<!-- Wikipedia description -->
			<p><em><small>
			Busan (부산 (Korean pronunciation: [pusan]), officially Busan Metropolitan City), Latinized Pusan before 2000,[3] is South Korea's second largest metropolis after Seoul, with a population of approximately 3.6 million.[1] The Metropolitan area (includes adjacent cities of Gimhae and Yangsan) population is 4,573,533 as of December 2012. Including Ulsan and South Gyeongsang Province, its population is over 8 million.[4] It has Korea's largest beach and longest river. It is the largest port city in South Korea and the world's fifth busiest seaport by cargo tonnage.[5] The city is located on the southeastern-most tip of the Korean peninsula. The most densely built up areas of the city are situated in a number of narrow valleys between the Nakdong River and Suyeong River, with mountains separating some of the districts. Administratively, it is designated as a Metropolitan City. The Busan metropolitan area is divided into 15 major administrative districts and a single county.
			</small></em></p>
			
			<!-- Related pictures -->
			<div class="row">
				<div class="col-sm-6 col-md-3">
					<a href="#" class="thumbnail">
						<img src="/img/sample1.jpg" alt="Sample 1">
					</a>
				</div>
				<div class="col-sm-6 col-md-3">
					<a href="#" class="thumbnail">
						<img src="/img/sample2.jpg" alt="Sample 2">
					</a>
				</div>
				<div class="col-sm-6 col-md-3">
					<a href="#" class="thumbnail">
						<img src="/img/sample3.jpg" alt="Sample 3">
					</a>
				</div>
			</div>
		</div>
	</div>
    
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
    <script>
		function initialize() {
  			var map = new google.maps.Map(document.getElementById('map-canvas'), {
    			mapTypeId: google.maps.MapTypeId.ROADMAP
  			});
  			var defaultBounds = new google.maps.LatLngBounds(
      			new google.maps.LatLng(-33.8902, 151.1759),
      			new google.maps.LatLng(-33.8474, 151.2631));
  			map.fitBounds(defaultBounds);

  			var input = /** @type {HTMLInputElement} */(document.getElementById('target'));
  			console.log(input);
  			var searchBox = new google.maps.places.SearchBox(input);
  			var markers = [];

  			google.maps.event.addListener(searchBox, 'places_changed', function() {
    		var places = searchBox.getPlaces();

    		for (var i = 0, marker; marker = markers[i]; i++) {
      			marker.setMap(null);
    		}

    		markers = [];
    		var bounds = new google.maps.LatLngBounds();
    		for (var i = 0, place; place = places[i]; i++) {
      			var image = {
        			url: place.icon,
        			size: new google.maps.Size(71, 71),
        			origin: new google.maps.Point(0, 0),
        			anchor: new google.maps.Point(17, 34),
        			scaledSize: new google.maps.Size(25, 25)
      			};

      			var marker = new google.maps.Marker({
        			map: map,
        			icon: image,
        			title: place.name,
        			position: place.geometry.location
      			});
      			
      			var infowindow = new google.maps.InfoWindow({
      				content: "Button"
  				});
      			
      			google.maps.event.addListener(marker, 'click', function() {
    				infowindow.open(map,marker);
  				});

      			markers.push(marker);

      			bounds.extend(place.geometry.location);
    		}

    		map.fitBounds(bounds);
  		});

  		google.maps.event.addListener(map, 'bounds_changed', function() {
    		var bounds = map.getBounds();
    		searchBox.setBounds(bounds);
  		});
  		
	
	
	var clickMarker;
	
	function placeMarker(location) {
  		if (clickMarker) {
    		clickMarker.setPosition(location);
  		} else {
    		clickMarker = new google.maps.Marker({
      			position: location,
      			map: map
    		});
  		}
	}
	google.maps.event.addListener(map, 'click', function(event) {
  		placeMarker(event.latLng);
	});
	}


	google.maps.event.addDomListener(window, 'load', initialize);
    </script>
    
{% endblock %}